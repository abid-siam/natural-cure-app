{% extends "layout.html" %}
{% block content %}
<<<<<<< HEAD
<div class="data-table-history">
    <h3 style="text-align: center">Your Diagnosis History</h3>
    Select from the table below <br>
    <form method="POST" action="/generateReport">
        <button class="btn btn-primary" type="submit" style="margin-bottom: 15px; margin-top: 10px;" id="report" disabled="disabled" data-toggle="tooltip" data-placement="top" title="Select a row">Create Report</button>
        <table id="viewRecordsTable" class="table table-bordered table-sm" cellspacing="0" width="100%">
=======
<div class="data-table">
    <h3 style="text-align: left">Your <i>Diagnosis & Treatment </i> History</h3>
    {% if records %}
    <form id="reportOnSubmit" method="POST" action="/generateReport">
        Select from the table below <br>
        <button class="btn btn-primary" type="submit" id="report" disabled="disabled">Create Report</button>
        <table id="viewRecordsTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
>>>>>>> b7f4ad7fdcb1fcc2d206232c188bd86f8b72b186
            <thead style="font-weight: bold">
            <tr>
                <th style="width: 10px;"></th>
                <th>Diagnosis Time</th>
                <th>Symptoms Reported</th>
                <th>Conditions Predicted</th>
                <th>Treatment Options</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td><input type="checkbox" name="checked" value="{{record.recordID}}" class="check"/></td>
                    <td>{{record.timestamp}}</td>
                    <td>
                        {% for symptom in record.symptoms %}
                            {% if not loop.last %}
                                {{symptom}},
                            {% else %}
                                {{symptom}}
                            {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        <table class="table table-sm" id = "inner-table" cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                <th class="th-sm">Condition</th>
                                <th class="th-sm">Probability</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for diagnosis in record.diagnoses %}
                                    <tr>
                                        {% set percent = diagnosis.probability * 100 %}
                                        <td>{{diagnosis.diagnosis}}</td>
                                        <td>{{'%.2f'|format(percent)}}%</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </td>
                    <td>
                        <table class="table table-sm" id="inner-table" cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                <th class="th-sm">Condition</th>
                                <th class="th-sm">Options</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for diagnosis in record.treatments %}
                                    <tr>
                                        <td>{{diagnosis.condition}}</td>
                                        <td>{{diagnosis.treatments}}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </td>
                    <td>
                        <button class="btn btn-danger btn-sm rounded-0" onclick="confirmDeleteRecord(this, '{{record.recordID}}')" type="button" data-toggle="tooltip" data-placement="top" title="Delete"><i class="fa fa-trash"></i></button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <th></th>
                    <th>Diagnosis Time</th>
                    <th>Symptoms Reported</th>
                    <th>Conditions Predicted</th>
                    <th>Treatment Options</th>
                </tr>
            </tfoot>
        </table>
    </form>
</div>
<<<<<<< HEAD
=======
    {% else %}
    <br>
    <p style="font-size: 20px;"> You have no <i>Diagnosis & Treatment </i> data recorded in our system. </p>
    {% endif %}
>>>>>>> b7f4ad7fdcb1fcc2d206232c188bd86f8b72b186
{% endblock content %}
<script>

   // Handle form submission event 
//    $('#reportOnSubmit').on('submit', function(e){
//       var form = this;
      
//       var rows_selected = table.column(0).checkboxes.selected();

//       // Iterate over all selected checkboxes
//       $.each(rows_selected, function(index, rowId){
//          // Create a hidden element 
//          $(form).append(
//              $('<input>')
//                 .attr('type', 'hidden')
//                 .attr('name', 'id[]')
//                 .val(rowId)
//          );
//       });
//    });   

</script>